<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - –ü–µ–∫–∞—Ä–Ω—è "–í–∫—É—Å–Ω—ã–π —É–≥–æ–ª–æ–∫"</title>
    <link rel="stylesheet" href="scss/main.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo-container">
                <a href="index.html" aria-label="–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É">
                    <div class="logo-placeholder">
                        <img src="images/logo.jpg" alt="" class="logo-placeholder">
                    </div>
                </a>
                <h1>–ü–µ–∫–∞—Ä–Ω—è "–í–∫—É—Å–Ω—ã–π —É–≥–æ–ª–æ–∫"</h1>
            </div>
            
            <nav class="main-nav" aria-label="–û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é">
                <ul>
                    <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="about.html">–û –Ω–∞—Å</a></li>
                    <li><a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                    <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                    <li><a href="dashboard.html" class="active">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></li>
                    <li><a href="#" class="cart-link">–ö–æ—Ä–∑–∏–Ω–∞ <span class="cart-count">0</span></a></li>
                </ul>
            </nav>
            
            <button class="mobile-menu-btn" aria-label="–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é">‚ò∞</button>
        </div>
    </header>

    <main>
        <section class="dashboard-hero">
            <div class="container">
                <h1>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
                <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º–∏ –∑–∞–∫–∞–∑–∞–º–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</p>
            </div>
        </section>

        <section class="user-info">
            <div class="container">
                <div class="user-card" id="user-card">
                    <!-- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</div>
                </div>
            </div>
        </section>

        <section class="dashboard-stats">
            <div class="container">
                <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫–∞–∑–æ–≤</h2>
                <div class="stats-grid" id="stats-grid">
                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</div>
                </div>
            </div>
        </section>

        <section class="orders-section">
            <div class="container">
                <div class="section-header">
                    <h2>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
                    <div class="filter-controls">
                        <select id="statusFilter" class="form-control">
                            <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
                            <option value="processing">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                            <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞</option>
                            <option value="cancelled">–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ</option>
                        </select>
                        <select id="sortOrders" class="form-control">
                            <option value="newest">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
                            <option value="oldest">–°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</option>
                            <option value="price-high">–ü–æ —Å—É–º–º–µ (—É–±—ã–≤.)</option>
                            <option value="price-low">–ü–æ —Å—É–º–º–µ (–≤–æ–∑—Ä.)</option>
                        </select>
                    </div>
                </div>
                
                <div class="orders-table-container">
                    <table class="orders-table">
                        <thead>
                            <tr>
                                <th data-sort="date">–î–∞—Ç–∞</th>
                                <th data-sort="id">‚Ññ –ó–∞–∫–∞–∑–∞</th>
                                <th>–¢–æ–≤–∞—Ä—ã</th>
                                <th data-sort="amount">–°—É–º–º–∞</th>
                                <th data-sort="status">–°—Ç–∞—Ç—É—Å</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <!-- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            <tr>
                                <td colspan="6" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination" id="pagination">
                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
        </section>

        <section class="quick-actions">
            <div class="container">
                <h2>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
                <div class="actions-grid">
                    <div class="action-card">
                        <div class="action-icon">üîÑ</div>
                        <h3>–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑</h3>
                        <p>–ë—ã—Å—Ç—Ä–æ –∑–∞–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–∫—É–ø–∫–∏</p>
                        <button class="btn btn-outline" onclick="dashboard.repeatLastOrder()">–í—ã–±—Ä–∞—Ç—å</button>
                    </div>
                    <div class="action-card">
                        <div class="action-icon">‚ù§Ô∏è</div>
                        <h3>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h3>
                        <p>–í–∞—à–∏ –ª—é–±–∏–º—ã–µ —Ç–æ–≤–∞—Ä—ã</p>
                        <button class="btn btn-outline" onclick="dashboard.viewFavorites()">–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å</button>
                    </div>
                    <div class="action-card">
                        <div class="action-icon">üìù</div>
                        <h3>–ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç–∑—ã–≤</h3>
                        <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º –º–Ω–µ–Ω–∏–µ–º</p>
                        <button class="btn btn-outline" onclick="dashboard.writeReview()">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                    </div>
                    <div class="action-card">
                        <div class="action-icon">‚öôÔ∏è</div>
                        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º</p>
                        <button class="btn btn-outline" onclick="dashboard.openSettings()">–ù–∞—Å—Ç—Ä–æ–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <div class="logo-placeholder">üçû</div>
                    <p>–ü–µ–∫–∞—Ä–Ω—è "–í–∫—É—Å–Ω—ã–π —É–≥–æ–ª–æ–∫"</p>
                    <p>–°–≤–µ–∂–∞—è –≤—ã–ø–µ—á–∫–∞ —Å –ª—é–±–æ–≤—å—é —Å 2010 –≥–æ–¥–∞</p>
                </div>
                
                <nav class="footer-nav" aria-label="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ–Ω—é">
                    <h4>–ú–µ–Ω—é</h4>
                    <ul>
                        <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="about.html">–û –Ω–∞—Å</a></li>
                        <li><a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                        <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                    </ul>
                </nav>
                
                <address class="footer-contact">
                    <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
                    <p>–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10</p>
                    <p><a href="tel:+74951234567">+7 (495) 123-45-67</a></p>
                    <p><a href="mailto:info@vkusniy-ugolok.ru">info@vkusniy-ugolok.ru</a></p>
                </address>
                
                <div class="footer-social">
                    <h4>–ú—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö</h4>
                    <ul>
                        <li><a href="#" aria-label="–ù–∞—à Instagram">Instagram</a></li>
                        <li><a href="#" aria-label="–ù–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ">VKontakte</a></li>
                        <li><a href="#" aria-label="–ù–∞—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Facebook">Facebook</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 –ü–µ–∫–∞—Ä–Ω—è "–í–∫—É—Å–Ω—ã–π —É–≥–æ–ª–æ–∫". –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <script src="js/auth.js"></script>
    <script src="js/api.js"></script>
    <script src="js/main.js"></script>
    <script>
        class UserDashboard {
            constructor() {
                this.orders = [];
                this.filteredOrders = [];
                this.currentPage = 1;
                this.itemsPerPage = 5;
                this.init();
            }

            async init() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
                const isAuthenticated = await auth.checkAuth();
                if (!isAuthenticated) {
                    window.location.href = 'login.html';
                    return;
                }

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                await this.loadUserData();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–∫–∞–∑—ã
                await this.loadOrders();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                await this.loadStats();
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
                this.initFilters();
                
                // –†–µ–Ω–¥–µ—Ä–∏–º –∑–∞–∫–∞–∑—ã
                this.renderOrdersTable();
            }

            async loadUserData() {
                const user = auth.getUser();
                if (user) {
                    const userCard = document.getElementById('user-card');
                    const memberSince = new Date(user.created_at).toLocaleDateString('ru-RU', {
                        year: 'numeric',
                        month: 'long'
                    });
                    
                    userCard.innerHTML = `
                        <div class="user-avatar">${user.name.charAt(0)}</div>
                        <div class="user-details">
                            <h2>${user.name}</h2>
                            <p>${user.email}</p>
                            <p class="member-since">–£—á–∞—Å—Ç–Ω–∏–∫ —Å ${memberSince}</p>
                        </div>
                        <button class="btn btn-outline" onclick="auth.logout()">–í—ã–π—Ç–∏</button>
                    `;
                }
            }

            async loadOrders() {
                try {
                    const response = await api.getUserOrders();
                    if (response.success && response.data) {
                        this.orders = response.data.map(order => ({
                            ...order,
                            items: typeof order.items === 'string' ? JSON.parse(order.items) : order.items,
                            date: order.created_at
                        }));
                        this.filteredOrders = [...this.orders];
                    }
                } catch (error) {
                    console.error('Error loading orders:', error);
                    this.showError('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–∫–∞–∑—ã');
                }
            }

            async loadStats() {
                try {
                    const response = await api.getUserStats();
                    if (response.success && response.data) {
                        const stats = response.data;
                        this.renderStats(stats);
                    }
                } catch (error) {
                    console.error('Error loading stats:', error);
                }
            }

            renderStats(stats) {
                const statsGrid = document.getElementById('stats-grid');
                
                const avgOrder = stats.totalOrders > 0 ? Math.round(stats.totalAmount / stats.totalOrders) : 0;
                
                statsGrid.innerHTML = `
                    <div class="stat-card fade-in-up">
                        <div class="stat-icon">üì¶</div>
                        <div class="stat-content">
                            <h3>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</h3>
                            <div class="stat-number">${stats.totalOrders || 0}</div>
                            <div class="stat-change positive">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</div>
                        </div>
                    </div>
                    <div class="stat-card fade-in-up">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3>–û–±—â–∞—è —Å—É–º–º–∞</h3>
                            <div class="stat-number">${Math.round(stats.totalAmount || 0)} ‚ÇΩ</div>
                            <div class="stat-change positive">–í—Å–µ–≥–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ</div>
                        </div>
                    </div>
                    <div class="stat-card fade-in-up">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-content">
                            <h3>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</h3>
                            <div class="stat-number">${avgOrder} ‚ÇΩ</div>
                            <div class="stat-change positive">–ù–∞ –æ–¥–∏–Ω –∑–∞–∫–∞–∑</div>
                        </div>
                    </div>
                    <div class="stat-card fade-in-up">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <h3>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</h3>
                            <div class="stat-number">
                                ${(stats.statusStats?.find(s => s.status === 'processing')?.count || 0) + 
                                  (stats.statusStats?.find(s => s.status === 'delivery')?.count || 0)}
                            </div>
                            <div class="stat-change">–¢—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è</div>
                        </div>
                    </div>
                `;
            }

            initFilters() {
                document.getElementById('statusFilter').addEventListener('change', () => {
                    this.filterOrders();
                    this.renderOrdersTable();
                });

                document.getElementById('sortOrders').addEventListener('change', (e) => {
                    this.sortOrders(e.target.value);
                    this.renderOrdersTable();
                });
            }

            filterOrders() {
                const statusFilter = document.getElementById('statusFilter').value;
                
                if (statusFilter === 'all') {
                    this.filteredOrders = [...this.orders];
                } else {
                    this.filteredOrders = this.orders.filter(order => order.status === statusFilter);
                }
                
                this.currentPage = 1;
            }

            sortOrders(criteria) {
                switch(criteria) {
                    case 'date':
                    case 'newest':
                        this.filteredOrders.sort((a, b) => new Date(b.date) - new Date(a.date));
                        break;
                    case 'oldest':
                        this.filteredOrders.sort((a, b) => new Date(a.date) - new Date(b.date));
                        break;
                    case 'price-high':
                        this.filteredOrders.sort((a, b) => b.total_amount - a.total_amount);
                        break;
                    case 'price-low':
                        this.filteredOrders.sort((a, b) => a.total_amount - b.total_amount);
                        break;
                }
            }

            renderOrdersTable() {
                const tbody = document.getElementById('ordersTableBody');
                
                if (this.filteredOrders.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="6" class="no-orders">
                                <div class="empty-state">
                                    <div class="empty-icon">üì¶</div>
                                    <h3>–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                                    <p>–°–æ–≤–µ—Ä—à–∏—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ –≤ –Ω–∞—à–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ</p>
                                    <a href="catalog.html" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
                                </div>
                            </td>
                        </tr>
                    `;
                    document.getElementById('pagination').innerHTML = '';
                    return;
                }

                // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
                const totalPages = Math.ceil(this.filteredOrders.length / this.itemsPerPage);
                const startIndex = (this.currentPage - 1) * this.itemsPerPage;
                const endIndex = startIndex + this.itemsPerPage;
                const pageOrders = this.filteredOrders.slice(startIndex, endIndex);

                // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∑–∞–∫–∞–∑–æ–≤
                tbody.innerHTML = pageOrders.map(order => `
                    <tr class="fade-in-up">
                        <td>${this.formatDate(order.date)}</td>
                        <td>#${order.id.toString().padStart(4, '0')}</td>
                        <td>
                            <div class="order-items">
                                ${Array.isArray(order.items) ? 
                                    order.items.map(item => `
                                        <span class="order-item">
                                            ${item.name}${item.quantity > 1 ? ` √ó${item.quantity}` : ''}
                                        </span>
                                    `).join('') : 
                                    '<span class="order-item">' + order.items + '</span>'
                                }
                            </div>
                        </td>
                        <td>${order.total_amount} ‚ÇΩ</td>
                        <td>
                            <span class="status-badge status-${order.status}">
                                ${this.getStatusText(order.status)}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline" onclick="dashboard.viewOrder(${order.id})">
                                –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                            </button>
                        </td>
                    </tr>
                `).join('');

                this.renderPagination(totalPages);
            }

            renderPagination(totalPages) {
                const pagination = document.getElementById('pagination');
                
                if (totalPages <= 1) {
                    pagination.innerHTML = '';
                    return;
                }

                let paginationHTML = '';
                
                // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"
                paginationHTML += `
                    <button class="page-link prev ${this.currentPage === 1 ? 'disabled' : ''}" 
                            ${this.currentPage === 1 ? 'disabled' : ''}
                            onclick="dashboard.prevPage()">
                        ‚Äπ
                    </button>
                `;

                // –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
                for (let i = 1; i <= totalPages; i++) {
                    if (i === 1 || i === totalPages || (i >= this.currentPage - 1 && i <= this.currentPage + 1)) {
                        paginationHTML += `
                            <button class="page-link ${i === this.currentPage ? 'active' : ''}" 
                                    onclick="dashboard.goToPage(${i})">
                                ${i}
                            </button>
                        `;
                    } else if (i === this.currentPage - 2 || i === this.currentPage + 2) {
                        paginationHTML += '<span class="page-dots">...</span>';
                    }
                }

                // –ö–Ω–æ–ø–∫–∞ "–í–ø–µ—Ä–µ–¥"
                paginationHTML += `
                    <button class="page-link next ${this.currentPage === totalPages ? 'disabled' : ''}" 
                            ${this.currentPage === totalPages ? 'disabled' : ''}
                            onclick="dashboard.nextPage()">
                        ‚Ä∫
                    </button>
                `;

                pagination.innerHTML = paginationHTML;
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ru-RU');
            }

            getStatusText(status) {
                const statusMap = {
                    'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω',
                    'processing': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
                    'delivery': '–î–æ—Å—Ç–∞–≤–∫–∞',
                    'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
                };
                return statusMap[status] || status;
            }

            prevPage() {
                if (this.currentPage > 1) {
                    this.currentPage--;
                    this.renderOrdersTable();
                }
            }

            nextPage() {
                const totalPages = Math.ceil(this.filteredOrders.length / this.itemsPerPage);
                if (this.currentPage < totalPages) {
                    this.currentPage++;
                    this.renderOrdersTable();
                }
            }

            goToPage(page) {
                this.currentPage = page;
                this.renderOrdersTable();
            }

            viewOrder(orderId) {
                const order = this.orders.find(o => o.id === orderId);
                if (order) {
                    let itemsHTML = '';
                    if (Array.isArray(order.items)) {
                        itemsHTML = order.items.map(item => `
                            <div class="order-detail-item">
                                <strong>${item.name}</strong>
                                <div>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${item.quantity}</div>
                                <div>–¶–µ–Ω–∞: ${item.price} ‚ÇΩ</div>
                            </div>
                        `).join('');
                    } else {
                        itemsHTML = `<div class="order-detail-item">${order.items}</div>`;
                    }
                    
                    alert(`
                        –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ #${order.id}
                        –î–∞—Ç–∞: ${this.formatDate(order.date)}
                        –°—Ç–∞—Ç—É—Å: ${this.getStatusText(order.status)}
                        –û–±—â–∞—è —Å—É–º–º–∞: ${order.total_amount} ‚ÇΩ
                        
                        –¢–æ–≤–∞—Ä—ã:
                        ${itemsHTML}
                    `);
                }
            }

            repeatLastOrder() {
                if (this.orders.length > 0) {
                    const lastOrder = this.orders[0];
                    if (confirm(`–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑ –æ—Ç ${this.formatDate(lastOrder.date)} –Ω–∞ —Å—É–º–º—É ${lastOrder.total_amount} ‚ÇΩ?`)) {
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞
                        alert('–ó–∞–∫–∞–∑ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É! –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.');
                    }
                } else {
                    alert('–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è');
                }
            }

            viewFavorites() {
                alert('–†–∞–∑–¥–µ–ª "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ" –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
            }

            writeReview() {
                alert('–ù–∞–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
            }

            openSettings() {
                alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è - –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
            }

            showError(message) {
                const tbody = document.getElementById('ordersTableBody');
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="error">
                            <div class="error-state">
                                <div class="error-icon">‚ö†Ô∏è</div>
                                <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                                <p>${message}</p>
                                <button class="btn btn-primary" onclick="dashboard.init()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                            </div>
                        </td>
                    </tr>
                `;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è dashboard
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboard = new UserDashboard();
        });
    </script>
</body>
</html>